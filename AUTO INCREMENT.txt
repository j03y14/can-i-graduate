CREATE DATABASE can_i_graduate;

GRANT ALL PRIVILEGES ON can_i_graduate.* TO 'cig_admin'@'localhost' IDENTIFIED BY '1';
GRANT ALL PRIVILEGES ON can_i_graduate.* TO 'cig_admin'@'127.0.0.1' IDENTIFIED BY '1';
GRANT ALL PRIVILEGES ON can_i_graduate.* TO 'cig_admin'@'::1' IDENTIFIED BY '1';
FLUSH PRIVILEGES;

USE can_i_graduate;

CREATE TABLE members(
   member_srl BIGINT(11) NOT NULL AUTO_INCREMENT,
   user_id VARCHAR(80) NOT NULL,
   nickname NVARCHAR(40) NOT NULL,
   email VARCHAR(180) NOT NULL,
   password VARCHAR(60) NOT NULL,
   major_srl BIGINT(11) NOT NULL,
   admission_year SMALLINT NOT NULL,
   campus NVARCHAR(80) NOT NULL,
   abeek CHAR(1),

   PRIMARY KEY(member_srl),
   UNIQUE(user_id),
   UNIQUE(nickname),
   UNIQUE(email)
);

CREATE TABLE majors(
   major_srl BIGINT(11) NOT NULL AUTO_INCREMENT,
   dept NVARCHAR(80) NOT NULL,
   name NVARCHAR(80) NOT NULL,

   PRIMARY KEY(major_srl),
   UNIQUE(name)
);

CREATE TABLE lectures(
   lecture_srl BIGINT(11) NOT NULL AUTO_INCREMENT,
   course_no BIGINT(11) NOT NULL,
   class_no SMALLINT NOT NULL,
   year SMALLINT NOT NULL,
   semester TINYINT NOT NULL,
   campus NVARCHAR(80) NOT NULL,
   college NVARCHAR(80) NOT NULL,
   dept NVARCHAR(80) NOT NULL,
   title NVARCHAR(180) NOT NULL,
   inst_name NVARCHAR(80) NOT NULL,
   credit TINYINT NOT NULL,
   course_class NVARCHAR(40) NOT NULL,
   course_type NVARCHAR(40) NOT NULL,
   abeek_type NVARCHAR(40),

   PRIMARY KEY(lecture_srl),
   UNIQUE(course_no)
);

CREATE TABLE attended_lectures( 
   member_srl BIGINT(11) NOT NULL,
   lecture_srl BIGINT(11) NOT NULL,
   grade NVARCHAR(40) NOT NULL,
   codeshare CHAR(1),

   PRIMARY KEY(member_srl, lecture_srl)
);

CREATE TABLE graduation_status(
   member_srl BIGINT(11) NOT NULL,
   gpa SMALLINT NOT NULL,
   gpa_major SMALLINT NOT NULL,
   english CHAR(1) DEFAULT 'N',
   korean_history CHAR(1) DEFAULT 'N',
   chinese_char CHAR(1) DEFAULT 'N',
   paper CHAR(1) DEFAULT 'N',
   counseling CHAR(1) DEFAULT 'N',
   portfolio CHAR(1) DEFAULT 'N',
   coding_boot_camp CHAR(1) DEFAULT 'N',
   topcit CHAR(1) DEFAULT 'N',
   open_source CHAR(1) DEFAULT 'N',

   PRIMARY KEY(member_srl)
);

INSERT INTO members (user_id, password) VALUES ('admin', 'admin');